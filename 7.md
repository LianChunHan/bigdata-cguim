---
title: "Pima Indians Diabetes Database"
output: github_document
---
##資料前處理
```{r setup, include=FALSE}
#install.packages("mlbench")
library(mlbench)
data(PimaIndiansDiabetes)
str(PimaIndiansDiabetes) 
head(PimaIndiansDiabetes)
PimaIndiansDiabetesC<-
PimaIndiansDiabetes[complete.cases(PimaIndiansDiabetes),]
c(nrow(PimaIndiansDiabetes),nrow(PimaIndiansDiabetesC))
PimaIndiansDiabetesC$Test<-F
PimaIndiansDiabetesC[
sample(1:nrow(PimaIndiansDiabetesC),nrow(PimaIndiansDiabetesC)/3),
]$Test<-T
c(sum(PimaIndiansDiabetesC$Test==F),sum(PimaIndiansDiabetesC$Test==T))
PimaIndiansDiabetesC$diabetes<-factor(PimaIndiansDiabetesC$diabetes,levels=c("pos","neg"))
```


##預測模型建立
使用迴歸分析,糖尿病是否會得
將diabetes設為y,其他各變項當作x

```{r cars}
fit<-glm(diabetes~.,PimaIndiansDiabetesC[PimaIndiansDiabetesC$Test==F,],family="binomial")
library(MASS)
finalFit<-stepAIC(fit,direction = "both",trace = F)
summary(finalFit)$coefficients
```

install.packages("caret")
install.packages("lattice")
install.packages("ggplot2")
##預測模型驗證，解釋
將正面的pos改成第一,sesitvity預測值達0.73左右
```{r pressure, echo=FALSE}
pimPred<-predict(finalFit,newdata = PimaIndiansDiabetesC[PimaIndiansDiabetesC$Test==T,])
pimAns<-ifelse(pimPred<0.5,"pos","neg") 
pimAns<-factor(pimAns,levels = c("pos","neg"))
#install.packages("caret")
#install.packages("lattice")
#install.packages("ggplot2")
library(caret)
sensitivity(pimAns,PimaIndiansDiabetesC[PimaIndiansDiabetesC$Test==T,]$diabetes)
specificity(pimAns,PimaIndiansDiabetesC[PimaIndiansDiabetesC$Test==T,]$diabetes)
posPredValue(pimAns,PimaIndiansDiabetesC[PimaIndiansDiabetesC$Test==T,]$diabetes)
negPredValue(pimAns,PimaIndiansDiabetesC[PimaIndiansDiabetesC$Test==T,]$diabetes)
```








